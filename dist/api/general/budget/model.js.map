{"version":3,"sources":["../../../../src/api/general/budget/model.js"],"names":["Schema","mongoose","ObjectId","Types","schemaCreate","name","Joi","string","optional","description","type","trim","valid","subsidiary","Object","values","SUBSIDIARY","year","number","amount","office","terminal","account_heading","created_by","required","schemaUpdate","updated_by","schema","String","enum","Number","ref","options","DATABASE","OPTIONS","newSchema","set","Budget","model"],"mappings":"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","file":"model.js","sourcesContent":["/**\r\n * @author 4Dcoder\r\n * @property {ObjectId} id Budget primaryKey\r\n * @property {String} name Budget name (required)\r\n * @property {String} type Budget Category ACCOUNT|OFFICE|SUBSIDIARY|TERMINAL\r\n * @property {String} description Budget description (required)\r\n * @property {String} subsidiary Budget PET|CHEM|PLANT|ENGR (required)\r\n * @property {Number} year Budget year e.g. 2020 Period is gotten from settings\r\n * @property {Number} amount Budget cap set for the given year\r\n * @property {ObjectId} office Budget for a given office\r\n * @property {ObjectId} terminal Budget Terminal\r\n * @property {ObjectId} account_heading Budget AccountHeading\r\n * @description Budget model holds records of the expenditure limit for a year\r\n */\r\nimport Joi from \"joi\";\r\nimport mongoose from \"mongoose\";\r\n// eslint-disable-next-line camelcase\r\nimport mongoose_csv from \"mongoose-csv\";\r\nimport { DATABASE, SUBSIDIARY } from \"../../../constants\";\r\n// eslint-disable-next-line import/no-cycle\r\nimport Staff from \"../staff/model\";\r\nimport Office from \"../office/model\";\r\nimport AccountHeading from \"../account-heading/model\";\r\n\r\nconst { Schema } = mongoose;\r\nconst { ObjectId } = Schema.Types;\r\n\r\nexport const schemaCreate = {\r\n    name: Joi.string().optional(),\r\n    description: Joi.string().optional(),\r\n    type: Joi.string().trim().valid([\"ACCOUNT\", \"OFFICE\", \"SUBSIDIARY\", \"TERMINAL\"]).optional(),\r\n    subsidiary: Joi.string().valid(Object.values(SUBSIDIARY)).optional(),\r\n    year: Joi.number().optional(),\r\n    amount: Joi.number().optional(),\r\n    office: Joi.string().optional(),\r\n    terminal: Joi.string().optional(),\r\n    account_heading: Joi.string().optional(),\r\n    created_by: Joi.string().required(),\r\n};\r\n\r\nexport const schemaUpdate = {\r\n    name: Joi.string().optional(),\r\n    description: Joi.string().optional(),\r\n    type: Joi.string().trim().valid([\"ACCOUNT\", \"OFFICE\", \"SUBSIDIARY\", \"TERMINAL\"]).optional(),\r\n    subsidiary: Joi.string().valid(Object.values(SUBSIDIARY)).optional(),\r\n    year: Joi.number().optional(),\r\n    amount: Joi.number().optional(),\r\n    office: Joi.string().optional(),\r\n    terminal: Joi.string().optional(),\r\n    account_heading: Joi.string().optional(),\r\n    updated_by: Joi.string().required(),\r\n};\r\n\r\nexport const schema = {\r\n    name: { type: String, required: true },\r\n    type: { type: String, enum: [\"ACCOUNT\", \"OFFICE\", \"SUBSIDIARY\", \"TERMINAL\"], required: true },\r\n    description: { type: String, required: true },\r\n    year: { type: Number, required: true },\r\n    amount: { type: Number, required: true },\r\n    subsidiary: {\r\n        type: String,\r\n        enum: Object.values(SUBSIDIARY),\r\n        required: true,\r\n    },\r\n    terminal: { type: ObjectId, ref: \"Terminal\" },\r\n    office: { type: ObjectId, ref: \"Office\" },\r\n    account_heading: { type: ObjectId, ref: \"AccountHeading\", required: true },\r\n    created_by: { type: ObjectId, ref: \"Staff\", required: true },\r\n    updated_by: { type: ObjectId, ref: \"Staff\" },\r\n};\r\n\r\nconst options = DATABASE.OPTIONS;\r\n\r\nconst newSchema = new Schema(schema, options);\r\nnewSchema.set(\"collection\", \"budget\");\r\n\r\nconst Budget = mongoose.model(\"Budget\", newSchema);\r\n\r\nexport default Budget;\r\n"]}