{"version":3,"sources":["../../../../src/api/general/multimedia/routes.js"],"names":["router","express","Router","get","req","res","sendFile","appRoot","fetchRecord","post","checkAuth","isValidStaff","createRecord","addImageAws","put","updateRecord","delete","deleteRecord"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;;;AAEA,IAAMA,SAASC,kBAAQC,MAAR,EAAf;;AAEA;;;;;;;AAOAF,OAAOG,GAAP,CAAW,SAAX,EAAsB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAChCA,MAAIC,QAAJ,CAAgBC,qBAAhB;AACH,CAFD;;AAIA;;;;;;;;;;AAUAP,OAAOG,GAAP,CAAW,SAAX,EAAsBK,uBAAtB;;AAEA;;;;;;;;;;;;;AAaAR,OAAOS,IAAP,CAAY,SAAZ,EAAuB,CAACC,wBAAD,EAAYC,2BAAZ,CAAvB,EAAkDC,wBAAlD;;AAEA;;;;;;;;;;;AAWAZ,OAAOS,IAAP,CAAY,aAAZ,EAA2B,CAACC,wBAAD,EAAYC,2BAAZ,CAA3B,EAAsDE,uBAAtD;;AAEA;;;;;;;;;AASAb,OAAOc,GAAP,CAAW,mBAAX,EAAgC,CAACJ,wBAAD,EAAYC,2BAAZ,CAAhC,EAA2DI,wBAA3D;;AAEA;;;;;;;;;AASAf,OAAOgB,MAAP,CAAc,mBAAd,EAAmC,CAACN,wBAAD,EAAYC,2BAAZ,CAAnC,EAA8DM,wBAA9D;;kBAEejB,M","file":"routes.js","sourcesContent":["import express from \"express\";\nimport appRoot from \"app-root-path\";\nimport { checkAuth, isValidStaff } from \"../../../middleware/authorization\";\nimport { addImageAws, createRecord, fetchRecord, updateRecord, deleteRecord } from \"./controller\";\n\nconst router = express.Router();\n\n/**\n * @api {get} /api/v1/upload to get the form for uploading images\n * @apiName RetrieveUploadForm\n * @apiGroup Image\n * @apiDescription The sample form allows you to test the API by uploading\n * and image and entering the image name that would be saved on db\n */\nrouter.get(\"/upload\", (req, res) => {\n    res.sendFile(`${appRoot}/src/upload/index.html`);\n});\n\n/**\n * @api {get} /api/v1/images?{query} Retrieve all image-assets\n * @apiName RetrieveImages\n * @apiGroup Image\n * @apiHeader {String} Authorization authorization token\n * @apiDescription image-assets name and url are stored on db. The images themselves\n * are stored on the AWS Bucket. The url points to it.\n * @apiSuccess {Object[]} rows List of image-assets.\n * @apiError {Object} 400 Some parameters may contain invalid values.\n */\nrouter.get(\"/images\", fetchRecord);\n\n/**\n * @api {post} /api/v1/images Create image-assets\n * @apiName CreateImage\n * @apiGroup Image\n * @apiHeader {String} Authorization authorization token\n * @apiParam {String} name required image-asset name\n * @apiParam {File} image required image-asset\n * @apiSuccess {Object} image-asset record's data.\n * @apiError {Object} 400 Some parameters may contain invalid values.\n * @apiDescription Images uploaded to this endpoint are stored locally\n * on the backend server. This is only a fall back option when AWS is\n * no longer available.\n */\nrouter.post(\"/images\", [checkAuth, isValidStaff], createRecord);\n\n/**\n * @api {post} /api/v1/images-aws Create image-assets\n * @apiName CreateImageAws\n * @apiGroup Image\n * @apiHeader {String} Authorization authorization token\n * @apiParam {String} name required image-asset name\n * @apiParam {File} image required image-asset\n * @apiSuccess {Object} image-asset record's data.\n * @apiError {Object} 400 Some parameters may contain invalid values.\n * @apiDescription Images uploaded to this endpoint are stored on AWS.\n */\nrouter.post(\"/images-aws\", [checkAuth, isValidStaff], addImageAws);\n\n/**\n * @api {put} /api/v1/images/{ImageId} Update image-assets\n * @apiName UpdateImage\n * @apiGroup Image\n * @apiHeader {String} Authorization authorization token\n * @apiParam {String} name required image-asset name\n * @apiParam {String} url required image-asset url on cloud\n * @apiError {Object} 400 Some parameters may contain invalid values.\n */\nrouter.put(\"/images/:recordId\", [checkAuth, isValidStaff], updateRecord);\n\n/**\n * @api {delete} /api/v1/images/{recordId} Delete image-assets\n * @apiName DeleteImage\n * @apiGroup Image\n * @apiHeader {String} Authorization authorization token\n * @apiParam {String} recordId required record ObjectId\n * @apiSuccess (Success 204) 204 No Content.\n * @apiError 404 image-asset not found.\n */\nrouter.delete(\"/images/:recordId\", [checkAuth, isValidStaff], deleteRecord);\n\nexport default router;\n"]}