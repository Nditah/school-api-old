{"version":3,"sources":["../../src/lib/helpers.js"],"names":["bcryptjs","JWT","toObjectId","baseId","mysqlId","oldId","toString","a","repeat","length","pmtName","timestamp","Date","toISOString","slice","dateDaysAgo","since","today","setDate","getDate","randomNum","Math","floor","random","cloneObject","model","source","Object","assign","getObjectByKey","arrayObject","key","value","find","obj","getSettings","arrObj","Obj","item","name","addToArrayOfObjects","arrayOfObjects","limit","newObjectElement","size","keys","push","splice","getClientAccess","req","ipAddress","ip","_remoteAddress","accessDate","_startTime","hasProp","prop","prototype","hasOwnProperty","call","isObjecId","id","match","generateOtp","num","hash","str","hashSync","saltRounds","cleanDeepObject","propName","depth","cleanObject","nextDate","d","genString","text","possible","i","charAt","daysIntoYear","date","UTC","getFullYear","getMonth","genCode","len","substr","hasNull","val","values","includes","undefined","stringToArrayPhone","arr","split","map","st","trim","filtered","filter","index","Set"],"mappings":"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","file":"helpers.js","sourcesContent":["import bcryptjs from \"bcryptjs\";\nimport { JWT } from \"../constants\";\n\nexport function toObjectId(baseId = \"5951bc91860d8b5ba\", mysqlId = 1) {\n    const oldId = mysqlId.toString(10);\n    const a = \"0\".repeat(7 - oldId.length);\n    return baseId + a + oldId;\n}\n\nexport function pmtName(mysqlId) {\n    if (mysqlId) {\n        const oldId = mysqlId.toString(10);\n        const a = \"0\".repeat(4 - oldId.length);\n        return a + oldId;\n    }\n    return mysqlId;\n}\n\nexport function timestamp() {\n    return `${new Date().toISOString().slice(0, 22)}Z`;\n    //   return new Date().toISOString().slice(0, 19).replace(\"T\", \" \")+\"Z\";\n}\n\nexport function dateDaysAgo(since = 0) {\n    const today = new Date();\n    today.setDate(today.getDate() - since);\n    return today.toISOString();\n}\n\nexport function randomNum() {\n    return Math.floor(Math.random() * 1000000);\n}\n\nexport function cloneObject(model = {}, source) {\n    return Object.assign(model, source);\n}\n\n/**\n * @description getObjectByKey returns the object from an Array of\n * Objects that has the key with a given value or undefined!\n * @param {Array} arrayObject Array of Objects\n * @param {String} key Object key could be a String or Integer\n * @param {String} value Object value could be a String or Integer\n */\nexport function getObjectByKey(arrayObject, key, value) {\n    return arrayObject.find(obj => obj[ key ] === value);\n}\n\nexport function getSettings(arrObj = [{}], value = \"\") {\n    const Obj = arrObj.find(item => item.name === value);\n    if (Obj) {\n        return Obj.value;\n    }\n    return 0;\n}\n\n/**\n * @description addToArrayOfObjects add a new object item to an array of objects\n * @param {Object} arrayOfObjects the array of object\n * @param {Number} limit maximum number of objects the array should not exceed\n * @param {Object} newObjectElement the new item to be added to the array of objects\n * @returns {Object} the new array of Objects\n */\nexport default function addToArrayOfObjects(arrayOfObjects, limit, newObjectElement) {\n    const size = Object.keys(arrayOfObjects).length;\n    if (size < limit) {\n        arrayOfObjects.push(newObjectElement);\n    } else {\n    // arr.splice(indexToRemove, numToRemove)\n        arrayOfObjects.splice(0, 1);\n        arrayOfObjects.push(newObjectElement);\n    }\n    return arrayOfObjects;\n}\n\n/**\n * @description getClientAccess get the Ip Address and TimeSTamp of a request object.\n * @param {String} req the request object\n * @returns {Object} { accessDate, ipAddress } access date and the ip address\n */\nexport function getClientAccess(req) {\n    const ipAddress = req.ip || req._remoteAddress;\n    // const lang = req.get(\"accept-language\");\n    const accessDate = req._startTime || \"\";\n    return { accessDate, ipAddress };\n}\n\nexport function hasProp(obj, prop) {\n    return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function isObjecId(id) {\n    if (id.match(/^[0-9a-fA-F]{24}$/)) return true;\n    return false;\n}\n\n/**\n * @returns a five-digit random number\n */\nexport function generateOtp() {\n    const num = Math.floor(Math.random() * 90000) + 10000;\n    return num;\n}\n\nexport function hash(str = \"\") {\n    return bcryptjs.hashSync(str, JWT.saltRounds);\n}\n\nexport function cleanDeepObject(obj) {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const propName in obj) {\n        if (!obj[ propName ] || obj[ propName ].length === 0) {\n            delete obj[ propName ];\n        } else if (typeof obj === \"object\") {\n            cleanDeepObject(obj[ propName ]);\n        }\n    }\n    return obj;\n}\n\nlet depth = 0;\n\n// eslint-disable-next-line complexity\nexport function cleanObject(obj) {\n    depth += 1;\n    // eslint-disable-next-line no-restricted-syntax\n    for (const propName in obj) {\n        if (!obj[ propName ] || obj[ propName ].length === 0) {\n            delete obj[ propName ];\n        } else if (typeof obj === \"object\") {\n            if (depth <= 3) cleanObject(obj[ propName ]);\n        }\n    }\n    return obj;\n}\n\nexport function nextDate(d = 1) {\n    return new Date(new Date().setDate(new Date().getDate() + d));\n}\n\nfunction genString(length) {\n    let text = \"\";\n    // \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n    const possible = \"ABCDEFGHJKLMNPQRSTUVWXYZ23456789\";\n    // eslint-disable-next-line no-plusplus\n    for (let i = 0; i < length; i++) {\n        text += possible.charAt(Math.floor(Math.random() * possible.length));\n    }\n    return text;\n}\n\nfunction daysIntoYear(date = new Date()) {\n    // eslint-disable-next-line max-len\n    return (Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()) - Date.UTC(date.getFullYear(), 0, 0)) / 24 / 60 / 60 / 1000;\n}\n\nexport function genCode(len = 9) {\n    let d = new Date().getFullYear().toString().substr(-2);\n    d += daysIntoYear();\n    if (len - d.length > 0) return d + genString(len - d.length);\n    return genString(len);\n}\n\nexport function hasNull(Obj = {}) {\n    const val = Object.values(Obj);\n    if (val.includes(null) || val.includes(undefined) || val.includes(\"\")) return true;\n    return false;\n}\n\nexport function stringToArrayPhone(str) {\n    const arr = str.split(\",\").map(st => st.trim()) || []; // remove spaces\n    const filtered = arr.filter((value, index) => (value.length >= 11 && value.length < 15));\n    return [...new Set(filtered)]; // Remove duplicates\n}\n"]}