{"version":3,"sources":["../../src/services/request.js"],"names":["localRequest","foreignRequest","port","process","env","PORT","apiUrl","NODE_ENV","API_URL","req","httpMethod","data","token","headersObj","Accept","json","payload","options","method","uri","body","headers","auth","bearer","then","response","catch","err","httpUrl"],"mappings":";;;;;QAUgBA,Y,GAAAA,Y;QAmBAC,c,GAAAA,c;;AA7BhB;;;;AACA;;AACA;;;;AAEA,IAAMC,OAAOC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAAjC;AACA,IAAIC,6BAA2BJ,IAA3B,SAAJ;AACA,IAAIC,QAAQC,GAAR,CAAYG,QAAZ,KAAyB,YAA7B,EAA2C;AACvCD,aAASH,QAAQC,GAAR,CAAYI,OAAZ,IAAuB,0CAAhC;AACH;;AAEM,SAASR,YAAT,CAAsBS,GAAtB,EAA2BC,UAA3B,EAAuCC,IAAvC,EAA6C;AAChD,QAAMC,QAAQ,6BAASH,GAAT,CAAd;AACA,QAAMI,aAAa;AACfC,gBAAQ,kBADO;AAEf,wBAAgB,kBAFD;AAGfC,cAAM;AAHS,KAAnB;AAKA,QAAMC,UAAU,sBAAYL,IAAZ,CAAhB;AACA,QAAMM,UAAU;AACZC,gBAAQR,UADI;AAEZS,aAAKb,MAFO;AAGZc,cAAMJ,OAHM;AAIZK,iBAASR,UAJG;AAKZS,cAAM,EAAEC,QAAQX,KAAV,EALM,EAKa;AACzBG,cAAM,IANM,CAMA;AANA,KAAhB;AAQA,WAAO,8BAAGE,OAAH,EAAYO,IAAZ,CAAiB;AAAA,eAAYC,QAAZ;AAAA,KAAjB,EAAuCC,KAAvC,CAA6C;AAAA,eAAOC,GAAP;AAAA,KAA7C,CAAP;AACH;;AAEM,SAAS1B,cAAT,CAAwBQ,GAAxB,EAA6BC,UAA7B,EAAyCkB,OAAzC,EAAkDjB,IAAlD,EAAwD;AAC3D,QAAMC,QAAQ,6BAASH,GAAT,CAAd;AACA,QAAMI,aAAa;AACfC,gBAAQ,kBADO;AAEf,wBAAgB,kBAFD;AAGfC,cAAM;AAHS,KAAnB;AAKA,QAAMC,UAAU,sBAAYL,IAAZ,CAAhB;AACA,QAAMM,UAAU;AACZC,gBAAQR,UADI;AAEZS,aAAKS,OAFO;AAGZR,cAAMJ,OAHM;AAIZK,iBAASR,UAJG;AAKZS,cAAM,EAAEC,QAAQX,KAAV,EALM,EAKa;AACzBG,cAAM,IANM,CAMA;AANA,KAAhB;AAQA,WAAO,8BAAGE,OAAH,EAAYO,IAAZ,CAAiB;AAAA,eAAYC,QAAZ;AAAA,KAAjB,EAAuCC,KAAvC,CAA6C;AAAA,eAAOC,GAAP;AAAA,KAA7C,CAAP;AACH","file":"request.js","sourcesContent":["import rp from \"request-promise\";\nimport { cleanObject } from \"../lib\";\nimport { getToken } from \"../middleware/authorization\";\n\nconst port = process.env.PORT || 5000;\nlet apiUrl = `http://0.0.0.0:${port}/api`;\nif (process.env.NODE_ENV === \"production\") {\n    apiUrl = process.env.API_URL || \"https://peacegroup-api.herokuapp.com/api\";\n}\n\nexport function localRequest(req, httpMethod, data) {\n    const token = getToken(req);\n    const headersObj = {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        json: true,\n    };\n    const payload = cleanObject(data);\n    const options = {\n        method: httpMethod,\n        uri: apiUrl,\n        body: payload,\n        headers: headersObj,\n        auth: { bearer: token }, // { 'user': 'myusername', 'pass': 'mypassword' },\n        json: true, // Automatically stringifies the body to JSON\n    };\n    return rp(options).then(response => response).catch(err => err);\n}\n\nexport function foreignRequest(req, httpMethod, httpUrl, data) {\n    const token = getToken(req);\n    const headersObj = {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        json: true,\n    };\n    const payload = cleanObject(data);\n    const options = {\n        method: httpMethod,\n        uri: httpUrl,\n        body: payload,\n        headers: headersObj,\n        auth: { bearer: token }, // { 'user': 'myusername', 'pass': 'mypassword' },\n        json: true, // Automatically stringifies the body to JSON\n    };\n    return rp(options).then(response => response).catch(err => err);\n}\n"]}