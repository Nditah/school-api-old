{"version":3,"sources":["../../src/services/request.js"],"names":["rp","cleanObject","getToken","port","process","env","PORT","apiUrl","NODE_ENV","API_URL","localRequest","req","httpMethod","data","token","headersObj","Accept","json","payload","options","method","uri","body","headers","auth","bearer","then","response","catch","err","foreignRequest","httpUrl"],"mappings":"AAAA,OAAOA,EAAP,MAAe,iBAAf;AACA,SAASC,WAAT,QAA4B,QAA5B;AACA,SAASC,QAAT,QAAyB,6BAAzB;;AAEA,MAAMC,OAAOC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAAjC;AACA,IAAIC,SAAU,kBAAiBJ,IAAK,MAApC;AACA,IAAIC,QAAQC,GAAR,CAAYG,QAAZ,KAAyB,YAA7B,EAA2C;AACvCD,aAASH,QAAQC,GAAR,CAAYI,OAAZ,IAAuB,0CAAhC;AACH;;AAED,OAAO,SAASC,YAAT,CAAsBC,GAAtB,EAA2BC,UAA3B,EAAuCC,IAAvC,EAA6C;AAChD,UAAMC,QAAQZ,SAASS,GAAT,CAAd;AACA,UAAMI,aAAa;AACfC,gBAAQ,kBADO;AAEf,wBAAgB,kBAFD;AAGfC,cAAM;AAHS,KAAnB;AAKA,UAAMC,UAAUjB,YAAYY,IAAZ,CAAhB;AACA,UAAMM,UAAU;AACZC,gBAAQR,UADI;AAEZS,aAAKd,MAFO;AAGZe,cAAMJ,OAHM;AAIZK,iBAASR,UAJG;AAKZS,cAAM,EAAEC,QAAQX,KAAV,EALM,EAKa;AACzBG,cAAM,IANM,CAMA;AANA,KAAhB;AAQA,WAAOjB,GAAGmB,OAAH,EAAYO,IAAZ,CAAiBC,YAAYA,QAA7B,EAAuCC,KAAvC,CAA6CC,OAAOA,GAApD,CAAP;AACH;;AAED,OAAO,SAASC,cAAT,CAAwBnB,GAAxB,EAA6BC,UAA7B,EAAyCmB,OAAzC,EAAkDlB,IAAlD,EAAwD;AAC3D,UAAMC,QAAQZ,SAASS,GAAT,CAAd;AACA,UAAMI,aAAa;AACfC,gBAAQ,kBADO;AAEf,wBAAgB,kBAFD;AAGfC,cAAM;AAHS,KAAnB;AAKA,UAAMC,UAAUjB,YAAYY,IAAZ,CAAhB;AACA,UAAMM,UAAU;AACZC,gBAAQR,UADI;AAEZS,aAAKU,OAFO;AAGZT,cAAMJ,OAHM;AAIZK,iBAASR,UAJG;AAKZS,cAAM,EAAEC,QAAQX,KAAV,EALM,EAKa;AACzBG,cAAM,IANM,CAMA;AANA,KAAhB;AAQA,WAAOjB,GAAGmB,OAAH,EAAYO,IAAZ,CAAiBC,YAAYA,QAA7B,EAAuCC,KAAvC,CAA6CC,OAAOA,GAApD,CAAP;AACH","file":"request.js","sourcesContent":["import rp from \"request-promise\";\nimport { cleanObject } from \"../lib\";\nimport { getToken } from \"../middleware/authorization\";\n\nconst port = process.env.PORT || 5000;\nlet apiUrl = `http://0.0.0.0:${port}/api`;\nif (process.env.NODE_ENV === \"production\") {\n    apiUrl = process.env.API_URL || \"https://peacegroup-api.herokuapp.com/api\";\n}\n\nexport function localRequest(req, httpMethod, data) {\n    const token = getToken(req);\n    const headersObj = {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        json: true,\n    };\n    const payload = cleanObject(data);\n    const options = {\n        method: httpMethod,\n        uri: apiUrl,\n        body: payload,\n        headers: headersObj,\n        auth: { bearer: token }, // { 'user': 'myusername', 'pass': 'mypassword' },\n        json: true, // Automatically stringifies the body to JSON\n    };\n    return rp(options).then(response => response).catch(err => err);\n}\n\nexport function foreignRequest(req, httpMethod, httpUrl, data) {\n    const token = getToken(req);\n    const headersObj = {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        json: true,\n    };\n    const payload = cleanObject(data);\n    const options = {\n        method: httpMethod,\n        uri: httpUrl,\n        body: payload,\n        headers: headersObj,\n        auth: { bearer: token }, // { 'user': 'myusername', 'pass': 'mypassword' },\n        json: true, // Automatically stringifies the body to JSON\n    };\n    return rp(options).then(response => response).catch(err => err);\n}\n"]}