{"version":3,"sources":["../../src/services/sms.js"],"names":["recipient","message","data","from","formatPhone","sender","body","to","client","messages","create","result","sendSmsAsync","req","res","twiml","toString","send","receiveSms","dotenv","require","SMS","config","smsApi","process","env","SMS_API","PEACE_SMS_SENDER","phone","str","trim","length","slice","sendSms","then","console","log","sid","readMultipleSms","each"],"mappings":";;;;;;;uEAgCA,iBAA4BA,SAA5B,EAAuCC,OAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AACUC,4BADV,GACiB;AACTC,kCAAMC,YAAYC,MAAZ,CADG;AAETC,kCAAML,OAFG;AAGTM,gCAAIH,YAAYJ,SAAZ;AAHK,yBADjB;AAAA;AAMmB,+BAAMQ,OAAOC,QAAP,CAAgBC,MAAhB,CAAuBR,IAAvB,CAAN;;AANnB;AAMUS,8BANV;AAAA,yDAOWA,MAPX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;oBAAeC,Y;;;;;AAUf;;;;;;;wEAIA,kBAA0BC,GAA1B,EAA+BC,GAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AACUC,6BADV,GACkB,EADlB,EACsB;;AAClBA,8BAAMd,OAAN,CAAc,0BAAd;AACMA,+BAHV,GAGoBc,MAAMC,QAAN,EAHpB;;AAIIF,4BAAIG,IAAJ,CAAShB,OAAT;;AAJJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;oBAAeiB,U;;;;;AAOf;;;;;AArDA,IAAMC,SAASC,QAAQ,QAAR,CAAf;;eACgBA,QAAQ,cAAR,C;IAARC,G,YAAAA,G;;AAERF,OAAOG,MAAP;;AAEA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,OAA3B;AACA,IAAMlB,SAAS,IAAf;AACA;AACA,IAAMH,SAASgB,IAAIM,gBAAnB;;AAEA,SAASvB,WAAT,CAAqBwB,KAArB,EAA4B;AACxB,QAAIC,MAAMD,MAAMZ,QAAN,EAAV;AACAa,UAAMA,IAAIC,IAAJ,EAAN;AACA,QAAID,IAAIE,MAAJ,KAAe,EAAf,IAAqBF,IAAK,CAAL,MAAa,GAAtC,EAA2C;AACvCA,uBAAaA,IAAIG,KAAJ,CAAU,CAAV,CAAb;AACH;AACD,QAAIH,IAAIE,MAAJ,KAAe,EAAnB,EAAuB;AACnBF,uBAAaA,GAAb;AACH;AACD,WAAOA,GAAP;AACH;;AAED,SAASI,OAAT,CAAiBjC,SAAjB,EAA4BC,OAA5B,EAAqC;AACjC,QAAMC,OAAO;AACTC,cAAMC,YAAYC,MAAZ,CADG;AAETC,cAAML,OAFG;AAGTM,YAAIH,YAAYJ,SAAZ;AAHK,KAAb;AAKAQ,WAAOC,QAAP,CAAgBC,MAAhB,CAAuBR,IAAvB,EACKgC,IADL,CACU;AAAA,eAAUC,QAAQC,GAAR,CAAYzB,OAAO0B,GAAnB,CAAV;AAAA,KADV;AAEH;;AAwBD,SAASC,eAAT,GAA2B;AACvB9B,WAAOC,QAAP,CAAgB8B,IAAhB,CAAqB;AAAA,eAAYJ,QAAQC,GAAR,CAAY3B,SAAS4B,GAArB,CAAZ;AAAA,KAArB;AACH;;QAEQJ,O,GAAAA,O;QAASrB,Y,GAAAA,Y;QAAcM,U,GAAAA,U;QAAYoB,e,GAAAA,e","file":"sms.js","sourcesContent":["const dotenv = require(\"dotenv\");\r\nconst { SMS } = require(\"../constants\");\r\n\r\ndotenv.config();\r\n\r\nconst smsApi = process.env.SMS_API;\r\nconst client = null;\r\n// eslint-disable-next-line new-cap\r\nconst sender = SMS.PEACE_SMS_SENDER;\r\n\r\nfunction formatPhone(phone) {\r\n    let str = phone.toString();\r\n    str = str.trim();\r\n    if (str.length === 11 && str[ 0 ] === \"0\") {\r\n        str = `+234${str.slice(1)}`;\r\n    }\r\n    if (str.length === 10) {\r\n        str = `+234${str}`;\r\n    }\r\n    return str;\r\n}\r\n\r\nfunction sendSms(recipient, message) {\r\n    const data = {\r\n        from: formatPhone(sender),\r\n        body: message,\r\n        to: formatPhone(recipient),\r\n    };\r\n    client.messages.create(data)\r\n        .then(result => console.log(result.sid));\r\n}\r\n\r\nasync function sendSmsAsync(recipient, message) {\r\n    const data = {\r\n        from: formatPhone(sender),\r\n        body: message,\r\n        to: formatPhone(recipient),\r\n    };\r\n    const result = await client.messages.create(data);\r\n    return result;\r\n}\r\n\r\n/**\r\n * Twilio Webhook for receiving sms\r\n * Receive message via this webhook set at the twilio user settings\r\n */\r\nasync function receiveSms(req, res) {\r\n    const twiml = \"\"; // new twilio.TwimlResponse();\r\n    twiml.message(\"Twilio incoming message:\");\r\n    const message = twiml.toString();\r\n    res.send(message);\r\n}\r\n\r\n// Read Multiple SMS Records\r\nfunction readMultipleSms() {\r\n    client.messages.each(messages => console.log(messages.sid));\r\n}\r\n\r\nexport { sendSms, sendSmsAsync, receiveSms, readMultipleSms };\r\n"]}