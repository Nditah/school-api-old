{"version":3,"sources":["../../../src/public/js/chat.js"],"names":["socket","io","messages","document","getElementById","$","submit","e","li","createElement","preventDefault","emit","val","appendChild","append","span","on","data","message","console","log","fetch","then","json","map","sender","formatTimeAgo","createdAt","messageInput","typing","addEventListener","user","innerText"],"mappings":";;AAAA;AACA,IAAIA,SAASC,IAAb;AACA,IAAIC,WAAWC,SAASC,cAAT,CAAwB,UAAxB,CAAf;;AAEA,CAAC,YAAW;AACVC,IAAE,MAAF,EAAUC,MAAV,CAAiB,UAASC,CAAT,EAAY;AAC3B,QAAIC,KAAKL,SAASM,aAAT,CAAuB,IAAvB,CAAT;AACAF,MAAEG,cAAF,GAF2B,CAEP;AACpBV,WAAOW,IAAP,CAAY,cAAZ,EAA4BN,EAAE,UAAF,EAAcO,GAAd,EAA5B;;AAEAV,aAASW,WAAT,CAAqBL,EAArB,EAAyBM,MAAzB,CAAgCT,EAAE,UAAF,EAAcO,GAAd,EAAhC;AACA,QAAIG,OAAOZ,SAASM,aAAT,CAAuB,MAAvB,CAAX;AACAP,aAASW,WAAT,CAAqBE,IAArB,EAA2BD,MAA3B,CAAkC,QAAQ,WAAR,GAAsB,IAAtB,GAA6B,UAA/D;;AAEAT,MAAE,UAAF,EAAcO,GAAd,CAAkB,EAAlB;;AAEA,WAAO,KAAP;AACD,GAZD;;AAcAZ,SAAOgB,EAAP,CAAU,UAAV,EAAsB,gBAAQ;AAC5B,QAAIR,KAAKL,SAASM,aAAT,CAAuB,IAAvB,CAAT;AACA,QAAIM,OAAOZ,SAASM,aAAT,CAAuB,MAAvB,CAAX;AACA,QAAIP,WAAWC,SAASC,cAAT,CAAwB,UAAxB,CAAf;AACAF,aAASW,WAAT,CAAqBL,EAArB,EAAyBM,MAAzB,CAAgCG,KAAKC,OAArC;AACAhB,aAASW,WAAT,CAAqBE,IAArB,EAA2BD,MAA3B,CAAkC,QAAQ,WAAR,GAAsB,IAAtB,GAA6B,UAA/D;AACAK,YAAQC,GAAR,CAAY,cAAZ;AACD,GAPD;AAQD,CAvBD;;AAyBA;AACA,CAAC,YAAW;AACVC,QAAM,QAAN,EACGC,IADH,CACQ,gBAAQ;AACZ,WAAOL,KAAKM,IAAL,EAAP;AACD,GAHH,EAIGD,IAJH,CAIQ,gBAAQ;AACZC,SAAKC,GAAL,CAAS,gBAAQ;AACf,UAAIhB,KAAKL,SAASM,aAAT,CAAuB,IAAvB,CAAT;AACA,UAAIM,OAAOZ,SAASM,aAAT,CAAuB,MAAvB,CAAX;AACAP,eAASW,WAAT,CAAqBL,EAArB,EAAyBM,MAAzB,CAAgCG,KAAKC,OAArC;AACAhB,eACGW,WADH,CACeE,IADf,EAEGD,MAFH,CAEU,QAAQG,KAAKQ,MAAb,GAAsB,IAAtB,GAA6BC,cAAcT,KAAKU,SAAnB,CAFvC;AAGD,KAPD;AAQD,GAbH;AAcD,CAfD;;AAiBA;;AAEA,IAAIC,eAAezB,SAASC,cAAT,CAAwB,SAAxB,CAAnB;AACA,IAAIyB,SAAS1B,SAASC,cAAT,CAAwB,QAAxB,CAAb;;AAEA;AACAwB,aAAaE,gBAAb,CAA8B,UAA9B,EAA0C,YAAM;AAC9C9B,SAAOW,IAAP,CAAY,QAAZ,EAAsB,EAAEoB,MAAM,SAAR,EAAmBb,SAAS,cAA5B,EAAtB;AACD,CAFD;;AAIAlB,OAAOgB,EAAP,CAAU,cAAV,EAA0B,gBAAQ;AAChCa,SAAOG,SAAP,GAAmBf,KAAKc,IAAL,GAAY,GAAZ,GAAkBd,KAAKC,OAA1C;AACAC,UAAQC,GAAR,CAAYH,KAAKc,IAAL,GAAYd,KAAKC,OAA7B;AACD,CAHD;;AAKA;AACAU,aAAaE,gBAAb,CAA8B,OAA9B,EAAuC,YAAM;AAC3C9B,SAAOW,IAAP,CAAY,YAAZ,EAA0B,EAA1B;AACD,CAFD;;AAIAX,OAAOgB,EAAP,CAAU,kBAAV,EAA8B,YAAM;AAClCa,SAAOG,SAAP,GAAmB,EAAnB;AACD,CAFD","file":"chat.js","sourcesContent":["/* eslint-disable no-var */\r\nvar socket = io();\r\nvar messages = document.getElementById(\"messages\");\r\n\r\n(function() {\r\n  $(\"form\").submit(function(e) {\r\n    let li = document.createElement(\"li\");\r\n    e.preventDefault(); // prevents page reloading\r\n    socket.emit(\"chat message\", $(\"#message\").val());\r\n\r\n    messages.appendChild(li).append($(\"#message\").val());\r\n    let span = document.createElement(\"span\");\r\n    messages.appendChild(span).append(\"by \" + \"Anonymous\" + \": \" + \"just now\");\r\n\r\n    $(\"#message\").val(\"\");\r\n\r\n    return false;\r\n  });\r\n\r\n  socket.on(\"received\", data => {\r\n    let li = document.createElement(\"li\");\r\n    let span = document.createElement(\"span\");\r\n    var messages = document.getElementById(\"messages\");\r\n    messages.appendChild(li).append(data.message);\r\n    messages.appendChild(span).append(\"by \" + \"anonymous\" + \": \" + \"just now\");\r\n    console.log(\"Hello bingo!\");\r\n  });\r\n})();\r\n\r\n// fetching initial chat messages from the database\r\n(function() {\r\n  fetch(\"/chats\")\r\n    .then(data => {\r\n      return data.json();\r\n    })\r\n    .then(json => {\r\n      json.map(data => {\r\n        let li = document.createElement(\"li\");\r\n        let span = document.createElement(\"span\");\r\n        messages.appendChild(li).append(data.message);\r\n        messages\r\n          .appendChild(span)\r\n          .append(\"by \" + data.sender + \": \" + formatTimeAgo(data.createdAt));\r\n      });\r\n    });\r\n})();\r\n\r\n//is typing...\r\n\r\nlet messageInput = document.getElementById(\"message\");\r\nlet typing = document.getElementById(\"typing\");\r\n\r\n//isTyping event\r\nmessageInput.addEventListener(\"keypress\", () => {\r\n  socket.emit(\"typing\", { user: \"Someone\", message: \"is typing...\" });\r\n});\r\n\r\nsocket.on(\"notifyTyping\", data => {\r\n  typing.innerText = data.user + \" \" + data.message;\r\n  console.log(data.user + data.message);\r\n});\r\n\r\n//stop typing\r\nmessageInput.addEventListener(\"keyup\", () => {\r\n  socket.emit(\"stopTyping\", \"\");\r\n});\r\n\r\nsocket.on(\"notifyStopTyping\", () => {\r\n  typing.innerText = \"\";\r\n});\r\n"]}